{#
/**
 * @file
 * Theme override for a select element.
 *
 * Available variables:
 * - attributes: HTML attributes for the <select> tag.
 * - options: The <option> element children.
 *
 * @see template_preprocess_select()
 */
#}

{% set select_classes =
  select_classes
    |default([])
    |merge(
      [
        'select',
        attributes.multiple ? 'form-multiselect' : 'form-select',
        attributes.class ? attributes.class|join(' ')|trim
      ]
    )
    |join(' ')
    |trim
%}
{# Update Attributes with New Classes + Supplemental Data #}
{% set select_attributes =
  attributes
    |default({})
    |merge({
      class: select_classes
    })
%}

{% apply spaceless %}
  <select {{ select_attributes|attributify }}>
    {% block select_content %}
      {% for option in options %}
          {% if option.type == 'optgroup' %}
            <optgroup label="{{ option.label }}">
              {% for sub_option in option.options %}
                <option value="{{ sub_option.value }}"
                  {{ sub_option.selected ? ' selected="selected"' }}
                  {{ option.disabled ? ' disabled' }}>
                  {{ sub_option.label }}
                </option>
              {% endfor %}
            </optgroup>
          {% elseif option.type == 'option' %}
            <option value="{{ option.value }}"
              {{ option.selected ? ' selected="selected"' }}
              {{ option.disabled ? ' disabled' }}>
              {{ option.label }}
            </option>
          {% endif %}
      {% endfor %}
    {% endblock select_content %}
  </select>
{% endapply %}
